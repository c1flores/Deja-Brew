{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Christian Flores/Desktop/UCB-VIRT-FSF-PT-07-2022-U-LOLC/22-State/02-Challenge/Main/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Christian Flores/Desktop/UCB-VIRT-FSF-PT-07-2022-U-LOLC/22-State/02-Challenge/Main/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Christian Flores/Desktop/UCB-VIRT-FSF-PT-07-2022-U-LOLC/22-State/02-Challenge/Main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from'react';import{useMutation}from'@apollo/client';import Jumbotron from'../components/Jumbotron';import{ADD_ORDER}from'../utils/mutations';import{idbPromise}from'../utils/helpers';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Success(){var _useMutation=useMutation(ADD_ORDER),_useMutation2=_slicedToArray(_useMutation,1),addOrder=_useMutation2[0];useEffect(function(){function saveOrder(){return _saveOrder.apply(this,arguments);}function _saveOrder(){_saveOrder=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var cart,products,_yield$addOrder,data,productData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return idbPromise('cart','get');case 2:cart=_context.sent;products=cart.map(function(item){return item._id;});if(!products.length){_context.next=11;break;}_context.next=7;return addOrder({variables:{products:products}});case 7:_yield$addOrder=_context.sent;data=_yield$addOrder.data;productData=data.addOrder.products;productData.forEach(function(item){idbPromise('cart','delete',item);});case 11:setTimeout(function(){window.location.assign('/');},3000);case 12:case\"end\":return _context.stop();}},_callee);}));return _saveOrder.apply(this,arguments);}saveOrder();},[addOrder]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Jumbotron,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Success!\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Thank you for your purchase!\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"You will now be redirected to the home page\"})]})});}export default Success;","map":{"version":3,"names":["React","useEffect","useMutation","Jumbotron","ADD_ORDER","idbPromise","Success","addOrder","saveOrder","cart","products","map","item","_id","length","variables","data","productData","forEach","setTimeout","window","location","assign"],"sources":["C:/Users/Christian Flores/Desktop/UCB-VIRT-FSF-PT-07-2022-U-LOLC/22-State/02-Challenge/Main/client/src/pages/Success.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useMutation } from '@apollo/client';\r\nimport Jumbotron from '../components/Jumbotron';\r\nimport { ADD_ORDER } from '../utils/mutations';\r\nimport { idbPromise } from '../utils/helpers';\r\n\r\nfunction Success() {\r\n  const [addOrder] = useMutation(ADD_ORDER);\r\n\r\n  useEffect(() => {\r\n    async function saveOrder() {\r\n      const cart = await idbPromise('cart', 'get');\r\n      const products = cart.map((item) => item._id);\r\n\r\n      if (products.length) {\r\n        const { data } = await addOrder({ variables: { products } });\r\n        const productData = data.addOrder.products;\r\n\r\n        productData.forEach((item) => {\r\n          idbPromise('cart', 'delete', item);\r\n        });\r\n      }\r\n\r\n      setTimeout(() => {\r\n        window.location.assign('/');\r\n      }, 3000);\r\n    }\r\n\r\n    saveOrder();\r\n  }, [addOrder]);\r\n\r\n  return (\r\n    <div>\r\n      <Jumbotron>\r\n        <h1>Success!</h1>\r\n        <h2>Thank you for your purchase!</h2>\r\n        <h2>You will now be redirected to the home page</h2>\r\n      </Jumbotron>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Success;\r\n"],"mappings":"wjBAAA,MAAOA,MAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,OAASC,WAAW,KAAQ,gBAAgB,CAC5C,MAAOC,UAAS,KAAM,yBAAyB,CAC/C,OAASC,SAAS,KAAQ,oBAAoB,CAC9C,OAASC,UAAU,KAAQ,kBAAkB,CAAC,wFAE9C,QAASC,QAAO,EAAG,CACjB,iBAAmBJ,WAAW,CAACE,SAAS,CAAC,8CAAlCG,QAAQ,kBAEfN,SAAS,CAAC,UAAM,SACCO,UAAS,uIAAxB,6MACqBH,WAAU,CAAC,MAAM,CAAE,KAAK,CAAC,QAAtCI,IAAI,eACJC,QAAQ,CAAGD,IAAI,CAACE,GAAG,CAAC,SAACC,IAAI,QAAKA,KAAI,CAACC,GAAG,GAAC,KAEzCH,QAAQ,CAACI,MAAM,gDACMP,SAAQ,CAAC,CAAEQ,SAAS,CAAE,CAAEL,QAAQ,CAARA,QAAS,CAAE,CAAC,CAAC,sCAApDM,IAAI,iBAAJA,IAAI,CACNC,WAAW,CAAGD,IAAI,CAACT,QAAQ,CAACG,QAAQ,CAE1CO,WAAW,CAACC,OAAO,CAAC,SAACN,IAAI,CAAK,CAC5BP,UAAU,CAAC,MAAM,CAAE,QAAQ,CAAEO,IAAI,CAAC,CACpC,CAAC,CAAC,CAAC,QAGLO,UAAU,CAAC,UAAM,CACfC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,GAAG,CAAC,CAC7B,CAAC,CAAE,IAAI,CAAC,CAAC,sDACV,4CAEDd,SAAS,EAAE,CACb,CAAC,CAAE,CAACD,QAAQ,CAAC,CAAC,CAEd,mBACE,kCACE,MAAC,SAAS,yBACR,oBAAI,UAAQ,EAAK,cACjB,oBAAI,8BAA4B,EAAK,cACrC,oBAAI,6CAA2C,EAAK,GAC1C,EACR,CAEV,CAEA,cAAeD,QAAO"},"metadata":{},"sourceType":"module"}